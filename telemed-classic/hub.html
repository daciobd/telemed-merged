<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TeleMed Ecosystem Hub</title>
  <link rel="stylesheet" href="/css/telemed-status.css">
  <style>
    :root{
      --brand:#0ea5e9; --teal:#2BB3A8; --ink:#0b1324; --ok:#059669; --bad:#dc2626;
      --text:#0f172a; --muted:#64748b; --card:#fff; --border:#e2e8f0; --bg:#f8fafc;
      --purple:#8b5cf6; --orange:#f97316; --pink:#ec4899;
    }
    *{box-sizing:border-box} 
    body{margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;background:var(--bg);color:var(--text)}
    
    .hub-header{
      background:linear-gradient(135deg, #1a1b23 0%, #2c2d39 100%);
      color:white;
      padding:32px 28px;
      text-align:center;
    }
    .hub-header h1{margin:0 0 8px;font-size:2rem}
    .hub-header p{margin:0;color:#9ca3af;font-size:1rem}
    .hub-header .back-link{
      display:inline-flex;align-items:center;gap:6px;
      color:#9ca3af;text-decoration:none;font-size:0.9rem;
      margin-bottom:16px;
    }
    .hub-header .back-link:hover{color:white}
    
    .hub-container{padding:28px;max-width:1400px;margin:0 auto}
    
    .hub-grid{
      display:grid;
      gap:24px;
      grid-template-columns:repeat(3, 1fr);
    }
    @media(max-width:1024px){.hub-grid{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:640px){.hub-grid{grid-template-columns:1fr}}
    
    .hub-column{display:flex;flex-direction:column;gap:16px}
    .hub-column-title{
      font-size:0.85rem;text-transform:uppercase;letter-spacing:1px;
      color:var(--muted);font-weight:600;margin-bottom:4px;
      display:flex;align-items:center;gap:8px;
    }
    
    .hub-card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:16px;
      padding:20px;
      box-shadow:0 2px 8px rgba(0,0,0,.04);
      transition:all 0.2s ease;
      text-decoration:none;
      color:inherit;
      display:block;
    }
    .hub-card:hover{
      box-shadow:0 8px 24px rgba(0,0,0,.1);
      transform:translateY(-2px);
      border-color:var(--brand);
    }
    .hub-card-header{display:flex;align-items:flex-start;gap:14px;margin-bottom:12px}
    .hub-card-icon{
      width:48px;height:48px;
      border-radius:12px;
      display:flex;align-items:center;justify-content:center;
      font-size:1.5rem;
      flex-shrink:0;
    }
    .hub-card-icon.teal{background:linear-gradient(135deg,#d1fae5,#a7f3d0);color:#059669}
    .hub-card-icon.blue{background:linear-gradient(135deg,#dbeafe,#bfdbfe);color:#2563eb}
    .hub-card-icon.purple{background:linear-gradient(135deg,#ede9fe,#ddd6fe);color:#7c3aed}
    .hub-card-icon.orange{background:linear-gradient(135deg,#ffedd5,#fed7aa);color:#ea580c}
    .hub-card-icon.pink{background:linear-gradient(135deg,#fce7f3,#fbcfe8);color:#db2777}
    .hub-card-icon.gray{background:linear-gradient(135deg,#f3f4f6,#e5e7eb);color:#4b5563}
    
    .hub-card-title{font-size:1.1rem;font-weight:600;color:var(--text);margin:0 0 4px}
    .hub-card-desc{font-size:0.9rem;color:var(--muted);margin:0;line-height:1.4}
    
    .hub-card-links{
      display:flex;flex-direction:column;gap:8px;
      margin-top:12px;padding-top:12px;
      border-top:1px solid var(--border);
    }
    .hub-card-links a{
      display:flex;align-items:center;gap:8px;
      padding:8px 12px;
      background:#f9fafb;
      border:1px solid var(--border);
      border-radius:8px;
      text-decoration:none;
      color:var(--text);
      font-size:0.85rem;
      transition:all 0.15s;
    }
    .hub-card-links a:hover{
      background:var(--brand);
      color:white;
      border-color:var(--brand);
    }
    
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:8px;
      background:var(--brand);color:#fff;border:0;
      padding:12px 20px;border-radius:10px;cursor:pointer;
      text-decoration:none;font-weight:500;font-size:0.95rem;
      transition:all 0.2s;
    }
    .btn:hover{background:#0284c7;transform:translateY(-1px)}
    .btn.ghost{background:transparent;color:var(--brand);border:1px solid var(--border)}
    .btn.ghost:hover{background:#f0f9ff;border-color:var(--brand)}
    .btn.teal{background:var(--teal)}
    .btn.teal:hover{background:#239e94}
    
    footer{
      margin-top:40px;padding:24px 28px;
      background:#1a1b23;color:#9ca3af;
      text-align:center;font-size:0.9rem;
    }
    footer a{color:var(--brand);text-decoration:none}
    footer a:hover{text-decoration:underline}
    
    .section-divider{
      margin:32px 0 24px;
      padding-bottom:8px;
      border-bottom:2px solid var(--border);
    }
    .section-divider h2{
      margin:0;font-size:1.3rem;color:var(--text);
      display:flex;align-items:center;gap:10px;
    }
  </style>
</head>
<body>

<header class="hub-header">
  <a href="/index.html" class="back-link">‚Üê Voltar ao In√≠cio</a>
  <h1>TeleMed Ecosystem Hub</h1>
  <p>Escolha o m√≥dulo que deseja acessar</p>
</header>

<div class="hub-container">
  
  <!-- Se√ß√£o Acesso R√°pido: Como Funciona -->
  <div style="margin-bottom:24px; padding:20px; background:#f0fdfa; border-radius:10px; border-left:5px solid #2bb3a8;">
    <h2 style="margin:0 0 12px; color:#2bb3a8; font-size:1.2rem">Como funciona o TeleMed?</h2>
    <p style="color:#374151; margin:0 0 12px; font-size:0.95rem">Veja explica√ß√µes curtas e objetivas sobre o funcionamento do ecossistema:</p>
    <ul style="line-height:1.8; margin:0; padding-left:20px; color:#374151">
      <li><a href="/paciente/como-funciona-bids.html" style="color:#0d9488; font-weight:600" data-testid="link-bids-paciente">Para Pacientes: Como funciona o sistema de ofertas (bids)</a></li>
      <li><a href="/medico/como-funciona-marketplace.html" style="color:#0d9488; font-weight:600" data-testid="link-marketplace-medico">Para M√©dicos: Consult√≥rio Virtual + Marketplace</a></li>
    </ul>
  </div>
  
  <div class="hub-grid">
    
    <!-- COLUNA 1: M√©dico Operacional -->
    <div class="hub-column">
      <div class="hub-column-title">
        <span>ü©∫</span> M√©dico Operacional
      </div>
      
      <a href="/consultorio/login" class="hub-card" data-testid="card-consultorio">
        <div class="hub-card-header">
          <div class="hub-card-icon teal">üè•</div>
          <div>
            <h3 class="hub-card-title">Consult√≥rio Virtual</h3>
            <p class="hub-card-desc">Agenda, consultas, marketplace e gest√£o di√°ria.</p>
          </div>
        </div>
        <div style="text-align:center">
          <span class="btn teal">Acessar Consult√≥rio</span>
        </div>
      </a>
      
      <a href="/dashboard/index.html" class="hub-card" data-testid="card-dashboard">
        <div class="hub-card-header">
          <div class="hub-card-icon blue">üìä</div>
          <div>
            <h3 class="hub-card-title">Painel Anal√≠tico</h3>
            <p class="hub-card-desc">Indicadores de volume, NPS, prescri√ß√£o e fila.</p>
          </div>
        </div>
        <div style="text-align:center">
          <span class="btn">Ver Dashboard</span>
        </div>
      </a>
    </div>
    
    <!-- COLUNA 2: IA e Suporte ao M√©dico -->
    <div class="hub-column">
      <div class="hub-column-title">
        <span>ü§ñ</span> IA e Suporte ao M√©dico
      </div>
      
      <a href="/dr-ai.html" class="hub-card" data-testid="card-dr-ai">
        <div class="hub-card-header">
          <div class="hub-card-icon purple">ü§ñ</div>
          <div>
            <h3 class="hub-card-title">Dr. AI ‚Äì Triagem</h3>
            <p class="hub-card-desc">Question√°rios inteligentes e triagem assistida por IA.</p>
          </div>
        </div>
      </a>
      
      <a href="/scribe-demo.html" class="hub-card" data-testid="card-scribe">
        <div class="hub-card-header">
          <div class="hub-card-icon orange">üìù</div>
          <div>
            <h3 class="hub-card-title">ScribeMedical</h3>
            <p class="hub-card-desc">Notas cl√≠nicas e resumos autom√°ticos de consulta.</p>
          </div>
        </div>
      </a>
      
      <a href="/rx-template.html" class="hub-card" data-testid="card-rx">
        <div class="hub-card-header">
          <div class="hub-card-icon pink">üíä</div>
          <div>
            <h3 class="hub-card-title">ReceitaCerta</h3>
            <p class="hub-card-desc">Modelos de prescri√ß√£o e receita digital.</p>
          </div>
        </div>
      </a>
    </div>
    
    <!-- COLUNA 3: Opera√ß√£o e Monitoramento -->
    <div class="hub-column">
      <div class="hub-column-title">
        <span>‚öôÔ∏è</span> Opera√ß√£o e Monitoramento
      </div>
      
      <div class="hub-card">
        <div class="hub-card-header">
          <div class="hub-card-icon gray">‚öôÔ∏è</div>
          <div>
            <h3 class="hub-card-title">Painel Administrativo</h3>
            <p class="hub-card-desc">Ferramentas de configura√ß√£o, telemetria e status.</p>
          </div>
        </div>
        <div class="hub-card-links">
          <a href="/admin-flags.html" data-testid="link-admin-flags">
            <span>üö©</span> Feature Flags
          </a>
          <a href="/public/admin-telemetry.html" data-testid="link-telemetry">
            <span>üì°</span> Telemetria
          </a>
          <a href="/status.html" data-testid="link-status">
            <span>üíö</span> Status dos Servi√ßos
          </a>
        </div>
      </div>
      
      <div class="hub-card">
        <div class="hub-card-header">
          <div class="hub-card-icon gray">üìã</div>
          <div>
            <h3 class="hub-card-title">Recursos Adicionais</h3>
            <p class="hub-card-desc">Demos, guias e centro de testes.</p>
          </div>
        </div>
        <div class="hub-card-links">
          <a href="/centro-de-testes/index.html" data-testid="link-testes">
            <span>üß™</span> Centro de Testes
          </a>
          <a href="/guia-teste.html" data-testid="link-guia">
            <span>üìñ</span> Guia de Testes
          </a>
          <a href="/demo.html" data-testid="link-demo">
            <span>üé¨</span> Demo Interativa
          </a>
        </div>
      </div>
    </div>
    
  </div>

  <!-- Se√ß√£o de Status T√©cnico (mantida do original) -->
  <div class="section-divider">
    <h2><span>üîß</span> Console T√©cnico (Dev)</h2>
  </div>
  
  <div id="telemed-status" 
       data-endpoints='["/api/health","https://telemed-auction.onrender.com/api/health","https://telemed-internal.onrender.com/api/health","https://telemed-productivity.onrender.com/api/health"]'
       data-hub-url="/hub.html"
       data-scribe-url="/scribe-demo.html">
  </div>

  <section class="hub-card" style="margin-top:16px">
    <h3 style="margin:0 0 12px;font-size:1rem">Servi√ßos (health) - Console t√©cnico</h3>
    <p style="color:var(--muted);font-size:0.85rem;margin-bottom:16px">
      Edite os endpoints se necess√°rio e clique em "Testar". Use "Abrir" para ver o <code style="background:#e2e8f0;padding:2px 6px;border-radius:4px">/healthz</code> em nova aba.
    </p>
    <div style="display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(300px,1fr))">
      <div>
        <label style="font-weight:500;font-size:0.85rem">AUCTION_URL</label>
        <div style="display:flex;gap:8px;margin-top:4px">
          <input id="auUrl" placeholder="https://telemed-auction.onrender.com" style="flex:1;padding:8px 10px;border:1px solid var(--border);border-radius:8px" />
          <button class="btn ghost" id="checkAuction" style="padding:8px 12px;font-size:0.85rem">Testar</button>
          <a class="btn ghost" id="openAuction" target="_blank" rel="noopener" style="padding:8px 12px;font-size:0.85rem">Abrir</a>
        </div>
        <div id="outAuction" style="margin-top:6px;font-size:0.85rem;color:var(--muted)"></div>
      </div>
      <div>
        <label style="font-weight:500;font-size:0.85rem">INTERNAL_URL</label>
        <div style="display:flex;gap:8px;margin-top:4px">
          <input id="inUrl" placeholder="https://telemed-internal.onrender.com" style="flex:1;padding:8px 10px;border:1px solid var(--border);border-radius:8px" />
          <button class="btn ghost" id="checkInternal" style="padding:8px 12px;font-size:0.85rem">Testar</button>
          <a class="btn ghost" id="openInternal" target="_blank" rel="noopener" style="padding:8px 12px;font-size:0.85rem">Abrir</a>
        </div>
        <div id="outInternal" style="margin-top:6px;font-size:0.85rem;color:var(--muted)"></div>
      </div>
      <div>
        <label style="font-weight:500;font-size:0.85rem">PRODUCTIVITY_URL</label>
        <div style="display:flex;gap:8px;margin-top:4px">
          <input id="prodUrl" placeholder="https://telemed-productivity.onrender.com" style="flex:1;padding:8px 10px;border:1px solid var(--border);border-radius:8px" />
          <button class="btn ghost" id="checkProd" style="padding:8px 12px;font-size:0.85rem">Testar</button>
          <a class="btn ghost" id="openProd" target="_blank" rel="noopener" style="padding:8px 12px;font-size:0.85rem">Abrir</a>
        </div>
        <div id="outProd" style="margin-top:6px;font-size:0.85rem;color:var(--muted)"></div>
      </div>
    </div>
  </section>

  <!-- Se√ß√£o de P√°ginas & Rotas (verifica√ß√£o de disponibilidade) -->
  <div class="section-divider">
    <h2><span>üìÑ</span> P√°ginas & Rotas</h2>
  </div>
  
  <section class="hub-card">
    <p style="color:var(--muted);font-size:0.85rem;margin-bottom:16px">
      O hub verifica se a rota existe (200) antes de exibir o selo ‚úÖ.
    </p>
    <ul id="routes" style="list-style:none;padding:0;margin:0"></ul>
  </section>

</div>

<footer>
  <p>TeleMed Ecosystem Hub &bull; <a href="/index.html">P√°gina Inicial</a> &bull; <a href="/consultorio/login">Consult√≥rio Virtual</a></p>
</footer>

<script>
  const DEFAULTS = {
    auction : 'https://telemed-auction.onrender.com',
    internal: 'https://telemed-internal.onrender.com',
    prod    : 'https://telemed-productivity.onrender.com',
  };
  const AU = document.getElementById('auUrl');
  const IN = document.getElementById('inUrl');
  const PR = document.getElementById('prodUrl');
  const OA = document.getElementById('openAuction');
  const OI = document.getElementById('openInternal');
  const OP = document.getElementById('openProd');

  AU.value = DEFAULTS.auction; IN.value = DEFAULTS.internal; PR.value = DEFAULTS.prod;

  function syncOpenLinks(){
    OA.href = AU.value.replace(/\/$/,'') + '/healthz';
    OI.href = IN.value.replace(/\/$/,'') + '/healthz';
    OP.href = PR.value.replace(/\/$/,'') + '/healthz';
  }
  [AU,IN,PR].forEach(el => el.addEventListener('input', syncOpenLinks));
  syncOpenLinks();

  async function health(url, outId){
    const out = document.getElementById(outId); out.innerHTML='';
    try{
      const r = await fetch(url.replace(/\/$/,'')+'/healthz', {method:'GET'});
      const ok = r.ok; let j = {};
      try{ j = await r.json(); }catch{}
      out.innerHTML = ok && j?.ok
        ? `<span style="display:inline-flex;align-items:center;gap:6px;padding:3px 8px;border-radius:999px;font-size:.8rem;border:1px solid #bbf7d0;background:#ecfdf5;color:#059669">OK</span> <code style="background:#e2e8f0;padding:2px 6px;border-radius:4px">${url}/healthz</code>`
        : `<span style="display:inline-flex;align-items:center;gap:6px;padding:3px 8px;border-radius:999px;font-size:.8rem;border:1px solid #fecaca;background:#fef2f2;color:#dc2626">Erro ${r.status}</span>`;
    }catch(e){
      out.innerHTML = `<span style="display:inline-flex;align-items:center;gap:6px;padding:3px 8px;border-radius:999px;font-size:.8rem;border:1px solid #fecaca;background:#fef2f2;color:#dc2626">Falha</span> <small style="color:var(--muted)">${String(e)}</small>`;
    }
  }
  document.getElementById('checkAuction').onclick = ()=>{ health(AU.value,'outAuction'); syncOpenLinks(); };
  document.getElementById('checkInternal').onclick= ()=>{ health(IN.value,'outInternal'); syncOpenLinks(); };
  document.getElementById('checkProd').onclick    = ()=>{ health(PR.value,'outProd'); syncOpenLinks(); };

  // P√°ginas & Rotas - verifica√ß√£o de disponibilidade
  const PAGES = [
    { label:'Consult√≥rio Virtual',        url:'/consultorio/login' },
    { label:'Dashboard Anal√≠tico',        url:'/dashboard/index.html' },
    { label:'Dr. AI - Triagem',           url:'/dr-ai.html' },
    { label:'ScribeMedical',              url:'/scribe-demo.html' },
    { label:'ReceitaCerta',               url:'/rx-template.html' },
    { label:'Feature Flags',              url:'/admin-flags.html' },
    { label:'Status dos Servi√ßos',        url:'/status.html' },
    { label:'Centro de Testes',           url:'/centro-de-testes/' },
    { label:'Cadastro de Paciente',       url:'/cadastro.html' },
    { label:'Cadastro de M√©dico',         url:'/cadastro-medico.html' },
    { label:'Como Funciona (Geral)',      url:'/como-funciona/' },
    { label:'Dr. AI - Assistente M√©dico', url:'/dr-ai/' },
    { label:'Agenda M√©dica',              url:'/agenda/' },
    { label:'Consulta Online',            url:'/consulta/' },
    { label:'Sala de Espera',             url:'/sala-de-espera/' },
    { label:'Pre√ßos',                     url:'/precos/' },
    { label:'Meus Pacientes',             url:'/meus-pacientes/' },
    { label:'Portal do M√©dico',           url:'/medico/' },
    { label:'Portal do Paciente',         url:'/paciente/' },
    { label:'Portal Dr. AI',              url:'/dr-ai/' },
    { label:'Portal P√∫blico (URL m√©dico)', url:'/dr/' },
    { label:'Demo Interativa',            url:'/demo.html' },
    { label:'Como Funciona - Bids',       url:'/paciente/como-funciona-bids.html' },
    { label:'Como Funciona - Marketplace', url:'/medico/como-funciona-marketplace.html' },
  ];

  async function buildRoutes(){
    const ul = document.getElementById('routes'); 
    if (!ul) return;
    ul.innerHTML = '';
    for (const p of PAGES){
      const li = document.createElement('li');
      li.style.cssText = 'display:flex;justify-content:space-between;gap:10px;padding:10px 12px;border:1px solid var(--border);border-radius:10px;margin-bottom:8px;background:#fff;align-items:center';
      const left = document.createElement('div');
      const right= document.createElement('div');

      left.innerHTML = `<a href="${p.url}" style="color:var(--brand);text-decoration:none;font-weight:600">${p.label}</a><div style="font-size:.85rem;color:var(--muted)">${p.url}</div>`;
      right.innerHTML= `<span id="b-${btoa(p.url)}" style="display:inline-flex;align-items:center;gap:6px;padding:3px 8px;border-radius:999px;font-size:.8rem;border:1px solid var(--border)">verificando‚Ä¶</span>`;
      li.appendChild(left); li.appendChild(right); ul.appendChild(li);

      try{
        const r = await fetch(p.url, {method:'GET'});
        const badge = document.getElementById(`b-${btoa(p.url)}`);
        if (r.ok) {
          badge.style.cssText = 'display:inline-flex;align-items:center;gap:6px;padding:3px 8px;border-radius:999px;font-size:.8rem;border:1px solid #bbf7d0;background:#ecfdf5;color:#059669';
          badge.textContent = '‚úÖ Existe';
        } else {
          badge.style.cssText = 'display:inline-flex;align-items:center;gap:6px;padding:3px 8px;border-radius:999px;font-size:.8rem;border:1px solid #fecaca;background:#fef2f2;color:#dc2626';
          badge.textContent = '‚ùå 404';
        }
      }catch{
        const badge = document.getElementById(`b-${btoa(p.url)}`);
        badge.style.cssText = 'display:inline-flex;align-items:center;gap:6px;padding:3px 8px;border-radius:999px;font-size:.8rem;border:1px solid #fecaca;background:#fef2f2;color:#dc2626';
        badge.textContent = '‚ö†Ô∏è Erro';
      }
    }
  }
  buildRoutes();

  const statusScript = document.createElement('script');
  statusScript.src = '/js/telemed-status.js';
  document.head.appendChild(statusScript);
</script>
</body>
</html>
